{
  "createdBy" : "sue@iacustomer.com",
  "createdDate" : null,
  "lastModifiedBy" : "sue@iacustomer.com",
  "lastModifiedDate" : null,
  "name" : "0c554a8b-f5eb-4ae2-8d7a-af02c26fdeb2",
  "query" : "declare namespace ia = \"urn:x-emc:ia:schema:fn\";\ndeclare namespace table=\"urn:x-emc:ia:schema:table\";\n\nimport module namespace sias=\"urn:x-sig:sias:util:fn\";\n\ndeclare variable $page external;\ndeclare variable $size external;\n\ndeclare variable $sVBELN external;\n\ndeclare function local:getResultsPage($rows, $page, $size) {\n  let $offset := $page * $size\n  let $total := count($rows)\n  return <results total=\"{ $total }\"> {\n    for $row in subsequence($rows, $offset + 1, $size)\n      return $row\n  } </results>\n};\n\ndeclare function local:addClause($whereClause as xs:string, $var as xs:string*, $expr as xs:string) as xs:string\n{\nif (empty($var) or $var = \"\")\nthen $whereClause\nelse if ($whereClause = \"\") then $expr else concat($whereClause, \" and \", $expr)\n};\n\n\nlet $whereClause := local:addClause(\"\", $sVBELN, concat(\"contains($lips/VBELN, &apos;\", $sVBELN, \"&apos;)\" ))\nlet $whereClause := if ($whereClause != \"\") then concat(\"where \", $whereClause) else $whereClause\n \nlet $query-str := concat(\"for $lips in /SAP/LIPS/ROW,$vbup in /SAP/VBUP/ROW[VBELN = $lips/VBELN and POSNR = $lips/POSNR] \", $whereClause, \" return <RS><LIPS>{ $lips }</LIPS><VBUP>{ $vbup }</VBUP></RS>\")\n\nlet $main-query := xhive:evaluate($query-str)\n\nlet $rows := \n               for $rs in $main-query\n               let $MBDAT := sias:showdate($rs/LIPS/ROW/MBDAT/text())\n    \nreturn\n<row id='{string($rs/LIPS/ROW/@table:id)}'>\n<column name='cPOSNR'>{ $rs/LIPS/ROW/POSNR/text() }</column>\n<column name='cMATNR'>{ $rs/LIPS/ROW/MATNR/text() }</column>\n<column name='cLFIMG'>{ $rs/LIPS/ROW/LFIMG/text() }</column>\n<column name='cVRKME'>{ $rs/LIPS/ROW/VRKME/text() }</column>\n<column name='cARKTX'>{ $rs/LIPS/ROW/ARKTX/text() }</column>\n<column name='cPSTYV'>{ $rs/LIPS/ROW/PSTYV/text() }</column>\n<column name='cPROFL'>{ $rs/LIPS/ROW/PROFL/text() }</column>\n\n<column name='cBRGEW'>{ $rs/LIPS/ROW/BRGEW/text() }</column>\n<column name='cGEWEI'>{ $rs/LIPS/ROW/GEWEI/text() }</column>\n<column name='cVOLUM'>{ $rs/LIPS/ROW/VOLUM/text() }</column>\n<column name='cVOLEH'>{ $rs/LIPS/ROW/VOLEH/text() }</column>\n\n<column name='cWERKS'>{ $rs/LIPS/ROW/WERKS/text() }</column>\n<column name='cLGORT'>{ $rs/LIPS/ROW/LGORT/text() }</column>\n<column name='cRFMNG'>{ $rs/VBFA/ROW/RFMNG/text() }</column>\n<column name='cMEINS'>{ $rs/VBFA/ROW/MEINS/text() }</column>\n<column name='cCHARG'>{ $rs/LIPS/ROW/CHARG/text() }</column>\n<column name='cKOSTA'>{ $rs/VBUP/ROW/KOSTA/text() }</column>\n<column name='cLVSTA'>{ $rs/LIPS/ROW/LVSTA/text() }</column>\n<column name='cMBDAT'>{ $MBDAT }</column>\n<column name='cBWTAR'>{ $rs/LIPS/ROW/BWTAR/text() }</column>\n\n<column name='cGRKOR'>{ $rs/LIPS/ROW/GRKOR/text() }</column>\n<column name='cKZTLF'>{ $rs/LIPS/ROW/KZTLF/text() }</column>\n<column name='cUEBTK'>{ $rs/LIPS/ROW/UEBTK/text() }</column>\n<column name='cUEBTO'>{ $rs/LIPS/ROW/UEBTO/text() } { \"%\" }</column>\n<column name='cUNTTO'>{ $rs/LIPS/ROW/UNTTO/text() } { \"%\" }</column>\n<column name='cKOSTA'>{ $rs/VBUP/ROW/KOSTA/text() }</column>\n<column name='cLVSTA'>{ $rs/VBUP/ROW/LVSTA/text() }</column>\n\n\n\n</row>\n\nreturn local:getResultsPage($rows, $page, $size)\n",
  "moduleNamespaces" : [ "urn:x-sig:sias:util:fn" ],
  "searchName" : "VL03 - Item Detail",
  "compositionName" : "Item Detail"
}