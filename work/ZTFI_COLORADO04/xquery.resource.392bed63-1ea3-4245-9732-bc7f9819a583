{
  "createdBy" : "connie@iacustomer.com",
  "createdDate" : null,
  "lastModifiedBy" : "connie@iacustomer.com",
  "lastModifiedDate" : null,
  "name" : "cd111bdd-d781-4aab-bf43-823964eff17a",
  "query" : "import module namespace sias=\"urn:x-sig:sias:util:fn\";\n\ndeclare namespace ia = \"urn:x-emc:ia:schema:fn\";\ndeclare namespace table=\"urn:x-emc:ia:schema:table\";\n\ndeclare variable $page external;\ndeclare variable $size external;\n\ndeclare variable $sBUKRS external;\ndeclare variable $sFAKT_G_KOSTL external;\ndeclare variable $sTEXT external;\ndeclare variable $sHKONT external;\n\n\ndeclare function local:getResultsPage($rows, $page, $size) \n{\n  let $offset := $page * $size\n  let $total := count($rows)\n  return <results total=\"{ $total }\"> {\n    for $row in subsequence($rows, $offset + 1, $size)\n      return $row\n  } </results>\n};\n\ndeclare function local:addClause($whereClause as xs:string, $var as xs:string*, $expr as xs:string) as xs:string\n{\nif (empty($var) or $var = \"\")\nthen $whereClause\nelse if ($whereClause = \"\") then $expr else concat($whereClause, \" and \", $expr)\n};\n\n\n\nlet $whereClause := local:addClause(\"\", $sBUKRS, concat(\"$rs/BUKRS = '\", $sBUKRS, \"'\" ))\nlet $whereClause := local:addClause($whereClause, $sFAKT_G_KOSTL, concat(\"$rs/FAKT_G_KOSTL = '\", $sFAKT_G_KOSTL, \"'\"))\nlet $whereClause := local:addClause($whereClause, $sTEXT, concat(\"contains($rs/TEXT, &apos;\", $sTEXT, \"&apos;)\"))\nlet $whereClause := local:addClause($whereClause, $sHKONT, concat(\"$rs/HKONT ='\", $sHKONT, \"'\"))\nlet $whereClause := if ($whereClause != \"\") then concat(\"where \", $whereClause) else $whereClause  \n   \n\nlet $query-str := concat(\"for $rs in /SAP/ZTFI_COLORADO04/ROW \", $whereClause, \" return $rs\") \n \nlet $main-query := xhive:evaluate($query-str)\n\nlet $rows :=  \n               for $rs in $main-query\n\t\tlet $MANDT := $rs/MANDT/text()\n\t\tlet $SYMBKTO := $rs/SYMBKTO/text()\n\t\tlet $BUKRS := $rs/BUKRS/text()\n\t\tlet $ABKRS := $rs/ABKRS/text()\n\t\tlet $WERKS := $rs/WERKS/text()\n\t\tlet $BTRTL := $rs/BTRTL/text()\n\t\tlet $MOMAG := $rs/MOMAG/text()\n\t\tlet $TEXT := $rs/TEXT/text()\n\t\tlet $BEZUG := $rs/BEZUG/text()\n\t\tlet $UE_KZ := $rs/UE_KZ/text()\n\t\tlet $HKONT := $rs/HKONT/text()\n\t\tlet $MWSKZ := $rs/MWSKZ/text()\n\t\tlet $TTYPE := $rs/TTYPE/text()\n\t\tlet $BCTPR := $rs/BCTPR/text()\n\t\tlet $KOSTL := $rs/KOSTL/text()\n\t\tlet $FAKTOR := $rs/FAKTOR/text()\n\t\tlet $FAKTOR_KZ := $rs/FAKTOR_KZ/text()\n\t\tlet $FAKT_HKONT := $rs/FAKT_HKONT/text()\n\t\tlet $FAKT_MWSKZ := $rs/FAKT_MWSKZ/text()\n\t\tlet $FAKT_TTYPE := $rs/FAKT_TTYPE/text()\n\t\tlet $FAKT_TPR := $rs/FAKT_TPR/text()\n\t\tlet $FAKT_KOSTL := $rs/FAKT_KOSTL/text()\n\t\tlet $FAKT_G_HKONT := $rs/FAKT_G_HKONT/text()\n\t\tlet $FAKT_G_MWSKZ := $rs/FAKT_G_MWSKZ/text()\n\t\tlet $FAKT_G_TTYPE := $rs/FAKT_G_TTYPE/text()\n\t\tlet $FAKT_G_TPR := $rs/FAKT_G_TPR/text()\n\t\tlet $FAKT_G_KOSTL := $rs/FAKT_G_KOSTL/text()\n\t\tlet $PC_REL := $rs/PC_REL/text()\n    \nreturn\n<row id='{string($rs/@table:id)}'>\n\t<column name='cMANDT'>{ $MANDT }</column>\n\t<column name='cSYMBKTO'>{ $SYMBKTO }</column>\n\t<column name='cBUKRS'>{ $BUKRS }</column>\n\t<column name='cABKRS'>{ $ABKRS }</column>\n\t<column name='cWERKS'>{ $WERKS }</column>\n\t<column name='cBTRTL'>{ $BTRTL }</column>\n\t<column name='cMOMAG'>{ $MOMAG }</column>\n\t<column name='cTEXT'>{ $TEXT }</column>\n\t<column name='cBEZUG'>{ $BEZUG }</column>\n\t<column name='cUE_KZ'>{ $UE_KZ }</column>\n\t<column name='cHKONT'>{ $HKONT }</column>\n\t<column name='cMWSKZ'>{ $MWSKZ }</column>\n\t<column name='cTTYPE'>{ $TTYPE }</column>\n\t<column name='cBCTPR'>{ $BCTPR }</column>\n\t<column name='cKOSTL'>{ $KOSTL }</column>\n\t<column name='cFAKTOR'>{ $FAKTOR }</column>\n\t<column name='cFAKTOR_KZ'>{ $FAKTOR_KZ }</column>\n\t<column name='cFAKT_HKONT'>{ $FAKT_HKONT }</column>\n\t<column name='cFAKT_MWSKZ'>{ $FAKT_MWSKZ }</column>\n\t<column name='cFAKT_TTYPE'>{ $FAKT_TTYPE }</column>\n\t<column name='cFAKT_TPR'>{ $FAKT_TPR }</column>\n\t<column name='cFAKT_KOSTL'>{ $FAKT_KOSTL }</column>\n\t<column name='cFAKT_G_HKONT'>{ $FAKT_G_HKONT }</column>\n\t<column name='cFAKT_G_MWSKZ'>{ $FAKT_G_MWSKZ }</column>\n\t<column name='cFAKT_G_TTYPE'>{ $FAKT_G_TTYPE }</column>\n\t<column name='cFAKT_G_TPR'>{ $FAKT_G_TPR }</column>\n\t<column name='cFAKT_G_KOSTL'>{ $FAKT_G_KOSTL }</column>\n\t<column name='cPC_REL'>{ $PC_REL }</column>\n</row>\n\nreturn local:getResultsPage($rows, $page, $size)\n\n",
  "moduleNamespaces" : [ "urn:x-sig:sias:util:fn" ],
  "searchName" : "ZTFI_COLORADO04",
  "compositionName" : "ZTFI_COLOR"
}